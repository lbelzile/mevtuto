<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Simulation | mev package tutorial</title>
  <meta name="description" content="This is a short tutorial on the use of the mev R package." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Simulation | mev package tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a short tutorial on the use of the mev R package." />
  <meta name="github-repo" content="lbelzile/mevdocu" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Simulation | mev package tutorial" />
  
  <meta name="twitter:description" content="This is a short tutorial on the use of the mev R package." />
  

<meta name="author" content="Léo Belzile" />


<meta name="date" content="2019-06-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="penultimate-approximation.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tutorial for the mev R package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a></li>
<li class="chapter" data-level="1" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html"><i class="fa fa-check"></i><b>1</b> Likelihood based inference for univariate extremes</a><ul>
<li class="chapter" data-level="1.1" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html#basic-theory"><i class="fa fa-check"></i><b>1.1</b> Basic theory</a><ul>
<li class="chapter" data-level="1.1.1" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html#likelihoods"><i class="fa fa-check"></i><b>1.1.1</b> Likelihoods</a></li>
<li class="chapter" data-level="1.1.2" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html#test-statistics-and-the-profile-likelihood"><i class="fa fa-check"></i><b>1.1.2</b> Test statistics and the profile likelihood</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html#numerical-example"><i class="fa fa-check"></i><b>1.2</b> Numerical example</a></li>
<li class="chapter" data-level="1.3" data-path="likelihood-based-inference-for-univariate-extremes.html"><a href="likelihood-based-inference-for-univariate-extremes.html#your-turn"><i class="fa fa-check"></i><b>1.3</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="threshold-selection.html"><a href="threshold-selection.html"><i class="fa fa-check"></i><b>2</b> Threshold selection</a><ul>
<li class="chapter" data-level="2.1" data-path="threshold-selection.html"><a href="threshold-selection.html#threshold-stability-plots"><i class="fa fa-check"></i><b>2.1</b> Threshold stability plots</a></li>
<li class="chapter" data-level="2.2" data-path="threshold-selection.html"><a href="threshold-selection.html#wadsworths-diagnostics-white-noise-process-and-simultaneous-threshold-stability-plots"><i class="fa fa-check"></i><b>2.2</b> Wadsworth’s diagnostics: white noise process and simultaneous threshold stability plots</a></li>
<li class="chapter" data-level="2.3" data-path="threshold-selection.html"><a href="threshold-selection.html#changepoint-tests-based-on-penultimate-approximation"><i class="fa fa-check"></i><b>2.3</b> Changepoint tests based on penultimate approximation</a></li>
<li class="chapter" data-level="2.4" data-path="threshold-selection.html"><a href="threshold-selection.html#extended-generalized-pareto"><i class="fa fa-check"></i><b>2.4</b> Extended generalized Pareto</a></li>
<li class="chapter" data-level="2.5" data-path="threshold-selection.html"><a href="threshold-selection.html#robust-selection"><i class="fa fa-check"></i><b>2.5</b> Robust selection</a></li>
<li class="chapter" data-level="2.6" data-path="threshold-selection.html"><a href="threshold-selection.html#your-turn-1"><i class="fa fa-check"></i><b>2.6</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="penultimate-approximation.html"><a href="penultimate-approximation.html"><i class="fa fa-check"></i><b>3</b> Penultimate approximation</a><ul>
<li class="chapter" data-level="3.1" data-path="penultimate-approximation.html"><a href="penultimate-approximation.html#your-turn-2"><i class="fa fa-check"></i><b>3.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>4</b> Simulation</a><ul>
<li class="chapter" data-level="4.1" data-path="simulation.html"><a href="simulation.html#max-stable-processes"><i class="fa fa-check"></i><b>4.1</b> Max-stable processes</a></li>
<li class="chapter" data-level="4.2" data-path="simulation.html"><a href="simulation.html#mathcalr-pareto-processes-and-generalizations"><i class="fa fa-check"></i><b>4.2</b> <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes and generalizations</a></li>
<li class="chapter" data-level="4.3" data-path="simulation.html"><a href="simulation.html#algorithms"><i class="fa fa-check"></i><b>4.3</b> Algorithms</a></li>
<li class="chapter" data-level="4.4" data-path="simulation.html"><a href="simulation.html#extremal-coefficient"><i class="fa fa-check"></i><b>4.4</b> Extremal coefficient</a></li>
<li class="chapter" data-level="4.5" data-path="simulation.html"><a href="simulation.html#generalized-mathcalr-pareto-processes-for-functional-threshold-exceedances"><i class="fa fa-check"></i><b>4.5</b> Generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes for functional threshold exceedances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>mev</code> package tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1">
<h1><span class="header-section-number">4</span> Simulation</h1>
<div id="max-stable-processes" class="section level2">
<h2><span class="header-section-number">4.1</span> Max-stable processes</h2>
<p>Let <span class="math inline">\(\mathcal{S}\)</span> be a compact subset of <span class="math inline">\(\mathbb{R}^d\)</span>
The de Haan spectral representation of simple max-stable processes is
<span class="math display">\[Z(\boldsymbol{s}) = \max_{i \in \mathbb{N}} \zeta_i W_i(\boldsymbol{s}), \qquad \boldsymbol{s} \in \mathcal{S},\]</span>
where <span class="math inline">\(\boldsymbol{W}\)</span> is a stochastic process satisfying <span class="math inline">\(\mathrm{E}\{W(\boldsymbol{s})_{+}\}=1\)</span> for any <span class="math inline">\(\boldsymbol{s} \in \mathcal{S}\)</span> and <span class="math inline">\(\{\zeta_i\}_{i \in \mathbb{N}}\)</span> is a Poisson point process with intensity function <span class="math inline">\(\zeta^{-2} \mathrm{d} \zeta\)</span>. Max-stable processes arise as the pointwise maximum of an infinite collection of random functions <span class="math inline">\(\varphi_i = \zeta_i \boldsymbol{W}_i\)</span>.</p>
<p>The distribution function of a <span class="math inline">\(D\)</span>-dimensional max-stable vector can be defined in terms of a measure <span class="math inline">\(\Lambda\)</span>, termed exponent measure, defined on <span class="math inline">\(\mathbb{R}^D \setminus\{\boldsymbol{0}_D\}\)</span> viz.
<span class="math display">\[\Pr(\boldsymbol{Z} \leq \boldsymbol{z}) = \exp\{\Lambda([-\boldsymbol{\infty}, \boldsymbol{z}]^\mathrm{c})\}, \boldsymbol{z} &gt; \boldsymbol{0}_D.\]</span>
It follows from max-stability that the exponent measure is homogeneous of order <span class="math inline">\(-1\)</span>.</p>
</div>
<div id="mathcalr-pareto-processes-and-generalizations" class="section level2">
<h2><span class="header-section-number">4.2</span> <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes and generalizations</h2>
<p>Let <span class="math inline">\(\mathcal{F}^+\)</span> denote the set of continuous non-negative non-null functions. A risk functional <span class="math inline">\(\mathcal{R}:\mathcal{F}^+ \to [0, \infty)\)</span> is a continuous functional which is homogeneous of order <span class="math inline">\(1\)</span>, i.e., <span class="math inline">\(\mathcal{R}(tf) = t\mathcal{R}(f)\)</span> for <span class="math inline">\(f \in \mathcal{F}^+\)</span> and <span class="math inline">\(t&gt;0\)</span>. A <span class="math inline">\(\mathcal{R}\)</span>-Pareto process admits the stochastic representation <span class="citation">(Ferreira and Haan <a href="#ref-Ferreira:2014" role="doc-biblioref">2014</a>, @Dombry/Ribatet:2015)</span>
<span class="math display">\[\begin{align}
  \mathsf{X} = P \frac{\mathsf{S}}{\mathcal{R}(\mathsf{S})},
 \end{align}\]</span>
for <span class="math inline">\(P\)</span> a unit Pareto random variable with survival function <span class="math inline">\(\Pr(P&gt;x) = x^{-\alpha}\)</span> for <span class="math inline">\(x \geq 1\)</span> and a stochastic process <span class="math inline">\(\mathsf{S}\)</span>, independent of <span class="math inline">\(P\)</span>, with sample paths in <span class="math inline">\(\mathbb{S}_{\mathrm{ang}} = \{f \in \mathcal{F}^+ \setminus \mathcal{C}_{\mathcal{R}}: \|f\|_{\mathrm{ang}} = 1\}\)</span> and where <span class="math inline">\(\mathcal{C}_{\mathcal{R}} = \{g \in \mathcal{F}^+: \mathcal{R}(x)=0\}\)</span> and <span class="math inline">\(\|\cdot\|_{\mathrm{ang}}\)</span> is a norm. <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes come about when looking at the limit distribution of <span class="math inline">\(\mathcal{R}\)</span>-exceedances, i.e. <span class="math inline">\(\{f: \mathcal{R}(f) &gt;u\}\)</span> for a large threshold <span class="math inline">\(u\)</span>, assuming unit Frechet margins. This can be achieved in practice by standardizing the margins, but with the drawback that the exceedances are defined on the transformed scale.</p>
<p><span class="citation">Fondeville (<a href="#ref-deFondeville:thesis" role="doc-biblioref">2018</a>)</span> lifts this assumption and define generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes, allowing for different location and scale marginal parameters (but with a common shape parameter).
The risk region in which extreme observations lie is
<span class="math display">\[\begin{align*}
\mathcal{A}_u= 
\left\{f \in \mathcal{F}^+ \setminus \mathcal{C}_{\mathcal{R}}: \mathcal{R}\left( \boldsymbol{\tau} \frac{f^\xi-1}{\xi}+\boldsymbol{\eta}\right) \geq u\right\},
\end{align*}\]</span>
where <span class="math inline">\(\boldsymbol{\eta}\)</span> is a location function and <span class="math inline">\(\boldsymbol{\tau}\)</span> is a scale function.
The probability measure of <span class="math inline">\(\mathsf{Z}^*\)</span> over <span class="math inline">\(\mathcal{A}_u\)</span> is <span class="math inline">\(\Lambda(\cdot)/\Lambda\{\mathcal{A}_u\}\)</span>.
The stochastic representation of the generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto vector is
<span class="math display">\[\begin{align}
    Z(\boldsymbol{s}) = \tau(\boldsymbol{s}) \frac{X(\boldsymbol{s})^{\xi}-1}{\xi}+ \eta(\boldsymbol{s}), 
\end{align}\]</span>
where <span class="math inline">\(X(\boldsymbol{s})\)</span> is a <span class="math inline">\(\mathcal{R}\)</span>-Pareto process. When <span class="math inline">\(\mathcal{R}\)</span> is <span class="math inline">\(\max\)</span>, the finite-dimensional distributions are multivariate generalized Pareto <span class="citation">(Rootzén, Segers, and Wadsworth <a href="#ref-Rootzen:2017" role="doc-biblioref">2018</a>)</span>.</p>
</div>
<div id="algorithms" class="section level2">
<h2><span class="header-section-number">4.3</span> Algorithms</h2>
<p>The original goal of the <code>mev</code> package was to implement the algorithm of <span class="citation">Dombry, Engelke, and Oesting (<a href="#ref-Dombry:2016" role="doc-biblioref">2016</a>)</span>, in order to perform exact simulation from max-stable vectors by sampling each extremal function in turn. Since then, other algorithms for simulating from standard <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes and generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes have been added to the package. These are based on accept-reject method or composition sampling and can be slow in high dimensions. Note that packages such as <code>RandomFields</code> and <code>SpatialExtremes</code> are tailored for spatial processes and include more efficient algorithms to sample the (log-)Gaussian components appearing in the Brown–Resnick and extremal Student models, which makes them typically faster. The vignette provides details about the parametrization of the models implemented in <code>mev</code>.</p>
<p>The various functions of interest for simulation include</p>
<ul>
<li><code>rmev</code>, which is the workshorse for simulating max-stable random vectors;</li>
<li><code>rmevspec</code> returns samples from the angular distribution defined with respect to the <span class="math inline">\(l_1\)</span> norm;</li>
<li><code>rparp</code> for simulating <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes through accept-reject;</li>
<li><code>rparpcs</code> for simulating <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes using composition sampling, e.g. <span class="citation">(<span class="citeproc-not-found" data-reference-id="Ho/Dombry:2019"><strong>???</strong></span>)</span></li>
<li><code>rgparp</code> for simulating generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes using accept-reject.</li>
</ul>
<p>This approach is only available for Brown–Resnick and extremal Student processes and is more computationally intensive since it requires computing numerically mixture weights. However, these need only be computed once and this approach is more efficient for simlating large samples, particularly in cases where the acceptance rate is very low (notably if <span class="math inline">\(R(\boldsymbol{X})=\min_{j=1}^DX_j\)</span>).</p>
<p>Let’s start by simulating from a simple max-stable random vector from the negative logistic model. The margins are unit Frechet, and we can verify this by pooling the observations and fitting a generalized extreme value distribution to the sample. The parameter estimates are correct, and a probability-probability plot shows that the .</p>
<p>If <span class="math inline">\(\boldsymbol{Z}\)</span> is a max-stable vector of size <span class="math inline">\(D\)</span> with standard Gumbel margins, with distribution function <span class="math inline">\(G(\boldsymbol{z}) = \exp[-V\{\exp(\boldsymbol{z})\}]\)</span>, then for any subset of size <span class="math inline">\(J \subseteq\{1, \ldots, D\}\)</span>, the variable <span class="math inline">\(Z_J=\max_{j \in J} Z(\boldsymbol{s}_j)\)</span> has distribution function <span class="math inline">\(H_J(z) = \exp\{-\exp(z-\mu_{J})\}\)</span>, where <span class="math inline">\(\mu_J=\log\{V_J(\boldsymbol{1})_{|J|})\}\)</span> and <span class="math inline">\(0 \leq \mu_J \leq \log(|J|)\)</span>. This follows from the homogeneity of the exponent measure. <span class="citation">Gabda et al. (<a href="#ref-Gabda:2012" role="doc-biblioref">2012</a>)</span> propose a probability-probability plot based on fitting <span class="math inline">\(\mu_J\)</span> through maximum likelihood with the parameter constraints for each set of <span class="math inline">\(|J|\)</span> stations. The data are obtained by pooling replications of the max-stable field and selecting all subsets of size <span class="math inline">\(|J|\)</span> if <span class="math inline">\(\binom{D}{|J|}\)</span> is small, or else a limited number of stations among those that display the higher dependence so as to maximize the power of the test (independence being a special case of max-stability). Uncertainty quantification is performed using a nonparametric bootstrap. The function <code>maxstabtest</code> implements this for the special case <span class="math inline">\(J=D\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mev)
<span class="kw">set.seed</span>(<span class="dv">0</span>)
samp &lt;-<span class="st"> </span><span class="kw">rmev</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">d =</span> <span class="dv">5</span>, <span class="dt">param =</span> <span class="fl">0.1</span>, <span class="dt">model =</span> <span class="st">&quot;neglog&quot;</span>) 
fgev &lt;-<span class="st"> </span><span class="kw">fit.gev</span>(<span class="kw">c</span>(samp), <span class="dt">show =</span> <span class="ot">FALSE</span>)
fgev<span class="op">$</span>estimate</code></pre>
<pre><code>##       loc     scale     shape 
## 0.9954939 0.9919429 0.9867670</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="co"># Test of max-stability</span>
<span class="kw">maxstabtest</span>(<span class="dt">dat =</span> samp)
<span class="co"># Probability-probability plot</span>
<span class="kw">plot</span>(fgev, <span class="dt">which =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p><img src="mevtuto_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The likelihood of max-stable processes is untractable, so inference is typically performed using composite likelihood. The package <code>evd</code> includes routines for doing this in the bivariate setting (see <code>fbvpot</code>).</p>
<p>Consider a collection of independent and identically distributed vectors <span class="math inline">\(\boldsymbol{X}\)</span> with continuous marginal distributions that are in the max-domain of attraction of a max-stable distribution with limit measure <span class="math inline">\(\Lambda\)</span>. One can transform the observations <span class="math inline">\(\boldsymbol{X}_i\)</span> into pseudo-uniform samples using the empirical distribution function or else the semi-parametric estimator,
<span class="math display">\[\begin{align}
 \check{F}_j(x) =
\begin{cases}
\mathrm{I}\{i: y_{ij} \leq x\}/(n+1), &amp;  x \leq u_j,\\
1-\{1-\tilde{F}_j(u_j)\}\left\{1+\hat{\xi}\left(\frac{x-u_j}{\hat{\tau}_j}\right)\right\}^{-1/\hat{\xi}_j}_{+}, &amp; x &gt;u_j.
\end{cases}
\end{align}\]</span>
(see <code>spunif</code>). We can back-transform the pseudo-uniform samples <span class="math inline">\(u_{ij} = \check{F}_j(y_{ij})\)</span> to unit Pareto using the quantile transform,
<span class="math inline">\(z_{ij}^{\mathrm{p}} = 1/1-(u_{ij})\)</span>. If we map the random vector <span class="math inline">\(\boldsymbol{Z}^{\mathrm{p}}\)</span> to pseudo-polar coordinates, <span class="math inline">\(\boldsymbol{Z}^{\mathrm{p}} \mapsto (R, \boldsymbol{\Omega})\)</span> from <span class="math inline">\(\mathbb{R}^D_{+} \to (0, \infty) \times \mathbb{S}_1\)</span>, where <span class="math inline">\(\mathbb{S}_1=\{ \boldsymbol{\omega} \in \mathbb{R}^D_{+}: \|\boldsymbol{\omega}\|_1=1\}\)</span> is the <span class="math inline">\(\ell_1\)</span>-simplex. The measure <span class="math inline">\(\Lambda\)</span> factorizes as a product measure <span class="math inline">\(\Lambda(\mathrm{d}\boldsymbol{z}) = D \zeta^{-2}\mathrm{d}\zeta \rho_1(\mathrm{d}\boldsymbol{\omega})\)</span> with angular measure <span class="math inline">\(\rho_1\)</span>, a probability measure satisfying the moment constraint <span class="math inline">\(D\int_{\mathbb{S}_1} \omega_j \rho_1(\mathrm{d}\boldsymbol{\omega})=1\)</span> for <span class="math inline">\(j=1, \ldots, D\)</span>; this moment constraint holds for any <span class="math inline">\(\rho_1\)</span>, whereas it will be measure dependent if the radial measure is not <span class="math inline">\(\|\cdot \|_1\)</span> <span class="citation">(Einmahl and Segers <a href="#ref-Einmahl:2009" role="doc-biblioref">2009</a>)</span>.
We can thus create an approximate sample <span class="math inline">\(\boldsymbol{\omega}\)</span> from the angular measure <span class="math inline">\(\rho_1\)</span> and estimate its distribution non-parametrically as
<span class="math display">\[\hat{H}(w) = \sum_{i=1}^N \hat{p}_i\mathrm{I}\{\omega_i \leq w\},\]</span>
where the weights <span class="math inline">\(\hat{p}_i\)</span> are obtained as the solution of either the empirical or Euclidean likelihood problems with a mean constraint <span class="citation">(Carvalho et al. <a href="#ref-deCarvalho:2013" role="doc-biblioref">2013</a>, @Einmahl:2009)</span>.
Since the resulting
spectral distribution is discrete (which is problematic in simulations), <span class="citation">Carvalho et al. (<a href="#ref-deCarvalho:2013" role="doc-biblioref">2013</a>)</span> suggest fitting a Dirichlet kernel to
observations, with parameters <span class="math inline">\(\nu \boldsymbol{w}_i (i=1, \ldots, D)\)</span> subject to the constraint <span class="math inline">\(\|\nu\boldsymbol{w}_{i}\|_1=1\)</span>. The’bandwidth’ tuning parameter <span class="math inline">\(\nu\)</span> is chosen via cross-validation. The function <code>angmeasdir</code> fits Euclidean likelihood and returns a list with the weights vector <code>wts</code>, the cross-validation parameter <code>nu</code> and a <span class="math inline">\(n \times D\)</span> matrix of parameters for the Dirichlet distribution.</p>
<p>Alternatively, we can estimate the limiting spectral measure
from the pseudo-observations enforcing the mean constraint using empirical likelihood, as proposed by <span class="citation">Einmahl and Segers (<a href="#ref-Einmahl:2009" role="doc-biblioref">2009</a>)</span>. The function <code>angmeas</code> computes the weights associated to each observations.</p>
<pre class="sourceCode r"><code class="sourceCode r">samp &lt;-<span class="st"> </span><span class="kw">rmev</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">d =</span> <span class="dv">3</span>, <span class="dt">param =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">2.9</span>, <span class="fl">0.1</span>), <span class="dt">model =</span> <span class="st">&quot;sdir&quot;</span>) 
<span class="kw">taildep</span>(samp, <span class="dt">method =</span> <span class="kw">list</span>(<span class="dt">eta =</span> <span class="st">&quot;betacop&quot;</span>, <span class="dt">chi =</span> <span class="st">&quot;betacop&quot;</span>))</code></pre>
<p><img src="mevtuto_files/figure-html/angdensplot-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">nparangmeas &lt;-<span class="st"> </span><span class="kw">angmeas</span>(samp, <span class="dt">th =</span> <span class="fl">0.5</span>)
<span class="co"># Plot the probability weights and compute the column mean</span>
<span class="kw">plot</span>(nparangmeas<span class="op">$</span>wts, <span class="dt">ylab =</span> <span class="st">&quot;Weights&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span><span class="op">/</span><span class="kw">nrow</span>(nparangmeas<span class="op">$</span>ang))</code></pre>
<p><img src="mevtuto_files/figure-html/angdensplot-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(nparangmeas<span class="op">$</span>wts <span class="op">*</span><span class="st"> </span>nparangmeas<span class="op">$</span>ang)</code></pre>
<pre><code>## [1] 0.3333333 0.3333333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">dirangmeas &lt;-<span class="st"> </span><span class="kw">angmeasdir</span>(samp, <span class="dt">th =</span> <span class="fl">0.5</span>)</code></pre>
</div>
<div id="extremal-coefficient" class="section level2">
<h2><span class="header-section-number">4.4</span> Extremal coefficient</h2>
<p>As in <code>SpatialExtremes</code>, we can use the nonparametric estimates of the extremal coefficient as goodness-of-fit diagnostic. The following code samples data</p>
<pre class="sourceCode r"><code class="sourceCode r">coord &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">*</span><span class="kw">cbind</span>(<span class="kw">runif</span>(<span class="dv">50</span>), <span class="kw">runif</span>(<span class="dv">50</span>))
di &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(coord))
dat &lt;-<span class="st"> </span><span class="kw">rmev</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">d =</span> <span class="dv">100</span>, <span class="dt">param =</span> <span class="dv">3</span>, <span class="dt">sigma =</span> <span class="kw">exp</span>(<span class="op">-</span>di<span class="op">/</span><span class="dv">2</span>), <span class="dt">model =</span> <span class="st">&#39;xstud&#39;</span>)
res &lt;-<span class="st"> </span><span class="kw">extcoef</span>(<span class="dt">dat =</span> dat, <span class="dt">coord =</span> coord)</code></pre>
<p><img src="mevtuto_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extremal Student extremal coefficient function</span>
XT.extcoeffun &lt;-<span class="st"> </span><span class="cf">function</span>(h, nu, corrfun, ...){
  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.function</span>(corrfun)){
    <span class="kw">stop</span>(<span class="st">&#39;Invalid function `corrfun`.&#39;</span>)
  }
  h &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">as.vector</span>(h))
  rhoh &lt;-<span class="st"> </span><span class="kw">sapply</span>(h, corrfun, ...)
  <span class="kw">cbind</span>(<span class="dt">h =</span> h, <span class="dt">extcoef =</span> <span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((nu<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>rhoh)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>rhoh)), nu<span class="op">+</span><span class="dv">1</span>))
}
<span class="co">#This time, only one graph with theoretical extremal coef</span>
<span class="kw">plot</span>(res<span class="op">$</span>dist, res<span class="op">$</span>extcoef, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;extremal coefficient&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;distance&quot;</span>)
extcoefxt &lt;-<span class="st"> </span><span class="kw">XT.extcoeffun</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">max</span>(res<span class="op">$</span>dist), <span class="dt">by =</span> <span class="fl">0.1</span>), <span class="dt">nu =</span> <span class="dv">3</span>,
                            <span class="dt">corrfun =</span> <span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)})
<span class="kw">lines</span>(extcoefxt[,<span class="st">&#39;h&#39;</span>], extcoefxt[,<span class="st">&#39;extcoef&#39;</span>], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre>
<p><img src="mevtuto_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
</div>
<div id="generalized-mathcalr-pareto-processes-for-functional-threshold-exceedances" class="section level2">
<h2><span class="header-section-number">4.5</span> Generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto processes for functional threshold exceedances</h2>
<p>We simulate a spatial generalized <span class="math inline">\(\mathcal{R}\)</span>-Pareto process.</p>
<pre class="sourceCode r"><code class="sourceCode r"> lon &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">650</span>, <span class="dv">720</span>, <span class="dt">length =</span> <span class="dv">50</span>)
 lat &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">215</span>, <span class="dv">290</span>, <span class="dt">length =</span> <span class="dv">50</span>)
 <span class="co"># Create a grid</span>
 grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(lon,lat)
 coord &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(grid)
 dianiso &lt;-<span class="st"> </span><span class="kw">distg</span>(coord, <span class="fl">1.5</span>, <span class="fl">0.5</span>)
 sgrid &lt;-<span class="st"> </span><span class="kw">scale</span>(grid, <span class="dt">scale =</span> <span class="ot">FALSE</span>)
 <span class="co"># Specify marginal parameters `loc` and `scale` over grid</span>
 eta &lt;-<span class="st"> </span><span class="dv">26</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>sgrid[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.16</span><span class="op">*</span>sgrid[,<span class="dv">2</span>]
 tau &lt;-<span class="st"> </span><span class="dv">9</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>sgrid[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.04</span><span class="op">*</span>sgrid[,<span class="dv">2</span>]
 <span class="co"># Parameter matrix of Huesler--Reiss</span>
 <span class="co"># associated to power variogram</span>
 Lambda &lt;-<span class="st"> </span>((dianiso<span class="op">/</span><span class="dv">30</span>)<span class="op">^</span><span class="fl">0.7</span>)<span class="op">/</span><span class="dv">4</span>
 <span class="co"># Simulate generalized max-Pareto field above u=50</span>
 <span class="kw">set.seed</span>(<span class="dv">345</span>)
 simu1 &lt;-<span class="st"> </span><span class="kw">rgparp</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">thresh =</span> <span class="dv">50</span>, <span class="dt">shape =</span> <span class="fl">0.1</span>, <span class="dt">riskf =</span> <span class="st">&quot;max&quot;</span>,
                 <span class="dt">scale =</span> tau, <span class="dt">loc =</span> eta, <span class="dt">sigma =</span> Lambda, <span class="dt">model =</span> <span class="st">&quot;hr&quot;</span>)
<span class="co"># The same, but conditional on an exceedance at a site    </span>
simu2 &lt;-<span class="st"> </span><span class="kw">rgparp</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">thresh =</span> <span class="dv">50</span>, <span class="dt">shape =</span> <span class="fl">0.1</span>, <span class="dt">riskf =</span> <span class="st">&quot;site&quot;</span>, 
                <span class="dt">siteindex =</span> <span class="dv">1225</span>, <span class="dt">scale =</span> tau, <span class="dt">loc =</span> eta,
                <span class="dt">sigma =</span> Lambda, <span class="dt">model =</span> <span class="st">&quot;hr&quot;</span>)
<span class="co">#Plot the generalized max-Pareto field</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
fields<span class="op">::</span><span class="kw">quilt.plot</span>(grid[,<span class="dv">1</span>], grid[,<span class="dv">2</span>], simu1, <span class="dt">nx =</span> <span class="dv">50</span>, <span class="dt">ny =</span> <span class="dv">50</span>)
SpatialExtremes<span class="op">::</span><span class="kw">swiss</span>(<span class="dt">add =</span> <span class="ot">TRUE</span>)
fields<span class="op">::</span><span class="kw">quilt.plot</span>(grid[,<span class="dv">1</span>], grid[,<span class="dv">2</span>], simu2, <span class="dt">nx =</span> <span class="dv">50</span>, <span class="dt">ny =</span> <span class="dv">50</span>)
SpatialExtremes<span class="op">::</span><span class="kw">swiss</span>(<span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="mevtuto_files/figure-html/simuRgpareto-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Value at conditioning coordinate should be greater than 50</span>
simu2[<span class="dv">1225</span>]</code></pre>
<pre><code>## [1] 84.81661</code></pre>
<p>The code snippet below fits a Brown–Resnick model with power variogram to simulated data from the same model (based on more than one replicate). The parameters are estimated by minimizing the squared distance between empirical cloud of pairwise conditional probability of exceedance and the theoretical one. We include geometric anisotropy in the analysis.</p>
<pre class="sourceCode r"><code class="sourceCode r"> lon &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">650</span>, <span class="dv">720</span>, <span class="dt">length =</span> <span class="dv">10</span>)
 lat &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">215</span>, <span class="dv">290</span>, <span class="dt">length =</span> <span class="dv">10</span>)
 <span class="co"># Create a grid</span>
 grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(lon,lat)
 coord &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(grid)
 dianiso &lt;-<span class="st"> </span><span class="kw">distg</span>(coord, <span class="fl">1.5</span>, <span class="fl">0.5</span>)
 sgrid &lt;-<span class="st"> </span><span class="kw">scale</span>(grid, <span class="dt">scale =</span> <span class="ot">FALSE</span>)
 <span class="co"># Specify marginal parameters `loc` and `scale` over grid</span>
 eta &lt;-<span class="st"> </span><span class="dv">26</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>sgrid[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.16</span><span class="op">*</span>sgrid[,<span class="dv">2</span>]
 tau &lt;-<span class="st"> </span><span class="dv">9</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span><span class="op">*</span>sgrid[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.04</span><span class="op">*</span>sgrid[,<span class="dv">2</span>]
 <span class="co"># Parameter matrix of Huesler--Reiss</span>
 <span class="co"># associated to power variogram</span>
 Lambda &lt;-<span class="st"> </span>((dianiso<span class="op">/</span><span class="dv">30</span>)<span class="op">^</span><span class="fl">0.7</span>)<span class="op">/</span><span class="dv">4</span>
 <span class="co"># Simulate generalized max-Pareto field above u=50</span>
 <span class="kw">set.seed</span>(<span class="dv">345</span>)
 simu1 &lt;-<span class="st"> </span><span class="kw">rgparp</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">thresh =</span> <span class="dv">50</span>, <span class="dt">shape =</span> <span class="fl">0.1</span>, <span class="dt">riskf =</span> <span class="st">&quot;max&quot;</span>,
                 <span class="dt">scale =</span> tau, <span class="dt">loc =</span> eta, <span class="dt">sigma =</span> Lambda, <span class="dt">model =</span> <span class="st">&quot;hr&quot;</span>)
 extdat &lt;-<span class="st"> </span><span class="kw">extremo</span>(<span class="dt">dat =</span> simu1, <span class="dt">margp =</span> <span class="fl">0.9</span>, <span class="dt">coord =</span> coord,
                   <span class="dt">scale =</span> <span class="fl">1.5</span>, <span class="dt">rho =</span> <span class="fl">0.5</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="mevtuto_files/figure-html/fitvariocloud-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># Constrained optimization</span>
 <span class="co"># Minimize distance between extremal coefficient from fitted variogram</span>
 mindistpvario &lt;-<span class="st"> </span><span class="cf">function</span>(par, emp, coord){
 alpha &lt;-<span class="st"> </span>par[<span class="dv">1</span>]; <span class="cf">if</span>(<span class="op">!</span><span class="kw">isTRUE</span>(<span class="kw">all</span>(alpha <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, alpha <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>))){<span class="kw">return</span>(<span class="fl">1e10</span>)}
 scale &lt;-<span class="st"> </span>par[<span class="dv">2</span>]; <span class="cf">if</span>(scale <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>){<span class="kw">return</span>(<span class="fl">1e10</span>)}
 a &lt;-<span class="st"> </span>par[<span class="dv">3</span>]; <span class="cf">if</span>(a<span class="op">&lt;</span><span class="dv">1</span>){<span class="kw">return</span>(<span class="fl">1e10</span>)}
 rho &lt;-<span class="st"> </span>par[<span class="dv">4</span>]; <span class="cf">if</span>(<span class="kw">abs</span>(rho) <span class="op">&gt;=</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">2</span>){<span class="kw">return</span>(<span class="fl">1e10</span>)}
 semivariomat &lt;-<span class="st"> </span>mgp<span class="op">::</span><span class="kw">power.vario</span>(<span class="kw">distg</span>(coord, a, rho), <span class="dt">alpha =</span> alpha, <span class="dt">scale =</span> scale)
   <span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="kw">sqrt</span>(semivariomat[<span class="kw">lower.tri</span>(semivariomat)]<span class="op">/</span><span class="dv">2</span>))) <span class="op">-</span><span class="st"> </span>emp)<span class="op">^</span><span class="dv">2</span>)
 }
 <span class="co"># constrained optimization for the parameters</span>
 hin &lt;-<span class="st"> </span><span class="cf">function</span>(par, ...){
   <span class="kw">c</span>(<span class="fl">1.99</span><span class="op">-</span>par[<span class="dv">1</span>], <span class="fl">-1e-5</span> <span class="op">+</span><span class="st"> </span>par[<span class="dv">1</span>],
     <span class="fl">-1e-5</span> <span class="op">+</span><span class="st"> </span>par[<span class="dv">2</span>],
     par[<span class="dv">3</span>]<span class="op">-</span><span class="dv">1</span>,
     pi<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>par[<span class="dv">4</span>],
     par[<span class="dv">4</span>]<span class="op">+</span>pi<span class="op">/</span><span class="dv">2</span>)
   }
 opt &lt;-<span class="st"> </span>alabama<span class="op">::</span><span class="kw">auglag</span>(<span class="dt">par =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>),
                        <span class="dt">hin =</span> hin, <span class="dt">control.optim =</span> <span class="kw">list</span>(<span class="dt">parscale =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">30</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>)),
                         <span class="dt">fn =</span> <span class="cf">function</span>(par){
                           <span class="kw">mindistpvario</span>(par, <span class="dt">emp =</span> extdat[,<span class="st">&#39;prob&#39;</span>], <span class="dt">coord =</span> coord)})</code></pre>
<pre><code>## Min(hin):  0.49999 
## Outer iteration:  1 
## Min(hin):  0.49999 
## par:  0.5 30 1.5 0.5 
## fval =   77.37 
##  
## Outer iteration:  2 
## Min(hin):  0.3992261 
## par:  0.668296 74.8862 1.39923 0.556808 
## fval =   6.52 
##  
## Outer iteration:  3 
## Min(hin):  0.3992502 
## par:  0.668285 74.8855 1.39925 0.556807 
## fval =   6.52 
## </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">stopifnot</span>(opt<span class="op">$</span>kkt1, opt<span class="op">$</span>kkt2)
 <span class="co"># Plotting the extremogram in the deformed space</span>
 distfa &lt;-<span class="st"> </span><span class="kw">distg</span>(<span class="dt">loc =</span> coord, opt<span class="op">$</span>par[<span class="dv">3</span>], opt<span class="op">$</span>par[<span class="dv">4</span>])
 <span class="kw">plot</span>(<span class="kw">c</span>(distfa[<span class="kw">lower.tri</span>(distfa)]), extdat[,<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">20</span>,
 <span class="dt">col =</span> scales<span class="op">::</span><span class="kw">alpha</span>(<span class="dv">1</span>,<span class="fl">0.1</span>), <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">bty =</span> <span class="st">&#39;l&#39;</span>,
      <span class="dt">xlab =</span> <span class="st">&quot;distance&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;cond. prob. of exceedance&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
 <span class="kw">lines</span>(<span class="dt">x =</span> (distvec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">200</span>, <span class="dt">length =</span> <span class="dv">1000</span>)), <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
       <span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="kw">sqrt</span>(<span class="kw">power.vario</span>(distvec, <span class="dt">alpha =</span> opt<span class="op">$</span>par[<span class="dv">1</span>], <span class="dt">scale =</span> opt<span class="op">$</span>par[<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span>))))</code></pre>
<p><img src="mevtuto_files/figure-html/fitvariocloud-2.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-deCarvalho:2013">
<p>Carvalho, Miguel de, Boris Oumow, Johan Segers, and Michał Warchoł. 2013. “A Euclidean Likelihood Estimator for Bivariate Tail Dependence.” <em>Communications in Statistics - Theory and Methods</em> 42 (7): 1176–92. <a href="https://doi.org/10.1080/03610926.2012.709905">https://doi.org/10.1080/03610926.2012.709905</a>.</p>
</div>
<div id="ref-Dombry:2016">
<p>Dombry, Clément, Sebastian Engelke, and Marco Oesting. 2016. “Exact Simulation of Max-Stable Processes.” <em>Biometrika</em> 103 (2): 303–17. <a href="https://doi.org/10.1093/biomet/asw008">https://doi.org/10.1093/biomet/asw008</a>.</p>
</div>
<div id="ref-Einmahl:2009">
<p>Einmahl, John H. J., and Johan Segers. 2009. “Maximum Empirical Likelihood Estimation of the Spectral Measure of an Extreme-Value Distribution.” <em>Ann. Statist.</em> 37 (5B): 2953–89. <a href="https://doi.org/10.1214/08-AOS677">https://doi.org/10.1214/08-AOS677</a>.</p>
</div>
<div id="ref-Ferreira:2014">
<p>Ferreira, Ana, and Laurens de Haan. 2014. “The Generalized Pareto Process; with a View Towards Application and Simulation.” <em>Bernoulli</em> 20 (4): 1717–37. <a href="https://doi.org/10.3150/13-BEJ538">https://doi.org/10.3150/13-BEJ538</a>.</p>
</div>
<div id="ref-deFondeville:thesis">
<p>Fondeville, Raphaël de. 2018. “Functional Peaks-over-Threshold Analysis for Complex Extreme Events.” PhD thesis, Lausanne: EPFL; MATH. <a href="https://doi.org/10.5075/epfl-thesis-8927">https://doi.org/10.5075/epfl-thesis-8927</a>.</p>
</div>
<div id="ref-Gabda:2012">
<p>Gabda, Darmesah, Ross Towe, Jennifer Wadsworth, and Jonathan Tawn. 2012. “Discussion of ‘Statistical Modeling of Spatial Extremes’ by A. C. Davison, S. A. Padoan and M. Ribatet.” <em>Statistical Science</em> 27 (2): 189–92. <a href="https://doi.org/10.1214/12-STS376B">https://doi.org/10.1214/12-STS376B</a>.</p>
</div>
<div id="ref-Rootzen:2017">
<p>Rootzén, Holger, Johan Segers, and Jennifer L. Wadsworth. 2018. “Multivariate Peaks over Thresholds Models.” <em>Extremes</em> 21 (1): 115–45. <a href="https://doi.org/10.1007/s10687-017-0294-4">https://doi.org/10.1007/s10687-017-0294-4</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="penultimate-approximation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["mevtuto.pdf", "mevtuto.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
